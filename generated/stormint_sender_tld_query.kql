// Data sourced from SANS Internet Storm Center / DShield API (https://isc.sans.edu/api/)
// Generated by StormInt TLD Query Generator

let suspicious_tlds = dynamic(["website", "win", "cfd", "bond", "cat", "vip", "link", "digital", "agency", "sbs", "mobi", "click", "online", "ink", "xyz", "fyi", "studio", "lol", "biz", "bet", "one", "live", "cloud", "site", "shop", "cyou", "pro", "dev", "today", "tech", "life", "top", "art", "icu", "blog", "asia", "buzz", "autos", "store", "guru", "app", "space", "quest", "work", "fun", "lat", "loan", "club", "world", "info"]);
EmailEvents
| where SenderFromDomain has_any (suspicious_tlds)
| project TimeGenerated, Subject, SenderFromAddress, RecipientEmailAddress, SenderFromDomain
| summarize count() by Subject, SenderFromAddress, RecipientEmailAddress, SenderFromDomain
| order by count_ desc
